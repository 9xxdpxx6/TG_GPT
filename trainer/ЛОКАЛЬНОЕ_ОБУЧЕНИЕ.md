# üöÄ –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## üìã –ß—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å

‚úÖ **–î–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤:** `training_dataset.json` (15,589 –¥–∏–∞–ª–æ–≥–æ–≤)  
‚úÖ **–°–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:** `train_model_locally_fixed.py`  
‚úÖ **–ñ–µ–ª–µ–∑–æ –ø–æ–¥—Ö–æ–¥–∏—Ç:** 16 –ì–ë –û–ó–£  

## üîß –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –í–∞—Ä–∏–∞–Ω—Ç A: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
```bash
pip install -r requirements.txt
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é)
```bash
pip install torch transformers datasets accelerate
```

## üéØ –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:
```bash
python train_model_locally.py
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - —á–∏—Ç–∞–µ—Ç –≤–∞—à –¥–∞—Ç–∞—Å–µ—Ç
2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** - —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç
3. **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏** - —Å–∫–∞—á–∏–≤–∞–µ—Ç DialoGPT-small (~500 –ú–ë)
4. **–û–±—É—á–µ–Ω–∏–µ** - 2 —ç–ø–æ—Ö–∏, ~1-3 —á–∞—Å–∞
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É `../dataset/my_dialogpt`

### ‚è±Ô∏è –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:
- **–° CPU:** 2-4 —á–∞—Å–∞
- **–° GPU:** 30-60 –º–∏–Ω—É—Ç
- **–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å** –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø–æ–∑–∂–µ

## üß™ –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞

### –ó–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞:
```bash
cd ../core && python generator.py
```

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞** (–∫–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)
2. **–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É** –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç–µ
3. **–ü–æ–ª—É—á–∏—Ç–µ 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞** –≤ –≤–∞—à–µ–º —Å—Ç–∏–ª–µ
4. **–í—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à–∏–π** –∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ** –≤ Telegram

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```
INFO:__main__:üöÄ –ó–∞–ø—É—Å–∫–∞—é –æ–±—É—á–µ–Ω–∏–µ...
INFO:__main__:–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-3 —á–∞—Å–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
INFO:__main__:–ú–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø–æ–∑–∂–µ
```

### –ü—Ä–æ–≥—Ä–µ—Å—Å:
- **–≠–ø–æ—Ö–∞ 1/2** - –±–∞–∑–æ–≤–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è
- **–≠–ø–æ—Ö–∞ 2/2** - —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ù–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏
```
‚ùå CUDA out of memory
```
**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í train_model_locally.py —É–º–µ–Ω—å—à–∏—Ç–µ:
per_device_train_batch_size=1  # –í–º–µ—Å—Ç–æ 2
gradient_accumulation_steps=8   # –í–º–µ—Å—Ç–æ 4
```

### 2. –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
```
üêå –û–±—É—á–µ–Ω–∏–µ –∏–¥–µ—Ç –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ
```
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä –Ω–µ –≤ —Å–ø—è—â–µ–º —Ä–µ–∂–∏–º–µ
- –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%

### 3. –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
```
‚ùå Model not found
```
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ú–æ–¥–µ–ª—å DialoGPT-small —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üéÆ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—É—á–µ–Ω–∏—è:
```
Ctrl+C  # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç –æ–±—É—á–µ–Ω–∏–µ
```

### –í—ã—Ö–æ–¥ –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞:
```
exit    # –í—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
```

### –ü—Ä–æ–ø—É—Å–∫ –æ—Ç–≤–µ—Ç–∞:
```
Enter   # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π –æ—Ç–≤–µ—Ç
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

```
dataset/
‚îú‚îÄ‚îÄ my_dialogpt/           # üÜï –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ config.json
‚îÇ   ‚îú‚îÄ‚îÄ pytorch_model.bin
‚îÇ   ‚îî‚îÄ‚îÄ tokenizer.json
‚îú‚îÄ‚îÄ results/               # üÜï –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ logs/                  # üÜï –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ training_dataset.json  # ‚úÖ –í–∞—à –¥–∞—Ç–∞—Å–µ—Ç
‚îú‚îÄ‚îÄ ../core/generator.py  # ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
‚îî‚îÄ‚îÄ train_model_locally.py # ‚úÖ –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
```

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —É –≤–∞—Å –±—É–¥–µ—Ç:

1. **–û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å** –≤ –ø–∞–ø–∫–µ `../dataset/my_dialogpt`
2. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π** –≤ –ø–∞–ø–∫–µ `../core/`
3. **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å** –æ—Ç–≤–µ—Ç—ã –≤ –≤–∞—à–µ–º —Å—Ç–∏–ª–µ
4. **–ü–æ–ª–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ

## üí° –°–æ–≤–µ—Ç—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –î–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞:
- **–ë–æ–ª—å—à–µ —ç–ø–æ—Ö:** –ò–∑–º–µ–Ω–∏—Ç–µ `num_train_epochs=3` –≤ —Å–∫—Ä–∏–ø—Ç–µ
- **–ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö:** –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —á–∞—Ç—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –ü–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å `temperature` –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ

### –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è:
- **GPU:** –ï—Å–ª–∏ –µ—Å—Ç—å, –æ–±—É—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ
- **–ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö:** –ù–∞—á–Ω–∏—Ç–µ —Å 5000 –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

**üéØ –ì–ª–∞–≤–Ω–æ–µ:** –ù–∞–±–µ—Ä–∏—Ç–µ—Å—å —Ç–µ—Ä–ø–µ–Ω–∏—è! –ü–µ—Ä–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç! 